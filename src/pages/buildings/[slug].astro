---
import { getCollection } from 'astro:content'

import Layout from '@layouts/Layout.astro'
import BuildingAttribute from '@components/BuildingAttribute.astro'
import PageHeader from '@components/PageHeader.astro'

export async function getStaticPaths() {
  const buildingsEntries = await getCollection('buildings')
  return buildingsEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }))
}

const { entry } = Astro.props
const { Content } = await entry.render()

const images = entry.data.images.map((image) => image + '-/scale_crop/1920x1080/smart/')
const featureImage = (entry.data.images || [])[0] + '-/scale_crop/1920x1080/center/'
---

<Layout title={entry.data.title}>
  <PageHeader title={entry.data.title} image={featureImage} size="lg" />

  <div class="max-w-7xl mx-auto relative">
    <div class="grid grid-cols-12 gap-16 py-16">
      <div class="col-span-7">
        <div class="text-lg">
          <Content />
        </div>
        <div class="grid grid-cols-2 gap-x-10 gap-y-6 mt-12">
          <BuildingAttribute label="Historic Status" value={entry.data.historic_status} />
          <BuildingAttribute label="Current Owner" value={entry.data.current_owner} />
          <BuildingAttribute
            label="Unique Features"
            value={entry.data.unique_features}
            className="col-span-2"
          />
        </div>
        {
          images && (
            <div class="grid grid-cols-2 gap-6 mt-12">
              {images.map((image) => (
                <img src={image} />
              ))}
            </div>
          )
        }
      </div>
      <div class="col-span-5">
        <div class="grid grid-cols-2 gap-x-8 gap-y-6">
          <BuildingAttribute label="Completed" value={entry.data.date_of_completion} />
          <BuildingAttribute label="Original Owner" value={entry.data.original_owner} />
          <BuildingAttribute label="Architect" value={entry.data.architect} />
          <BuildingAttribute label="Style" value={entry.data.style} />
        </div>
        <div class="mt-12">Map goes here ...</div>
        <div class="mt-12">Renovation history goes here ...</div>
      </div>
    </div>
  </div>
</Layout>
